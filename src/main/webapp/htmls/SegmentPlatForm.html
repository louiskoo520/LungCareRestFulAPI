<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <title>Segment PlatForm</title>
	
    <meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
    <meta http-equiv="description" content="this is my page">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">  
    <link rel="shortcut icon" href="../img/myicons/welcome.ico">
    	    <!-- 新 Bootstrap 核心 CSS 文件 -->
	<link rel="stylesheet" href="../css/bootstrap.min.css">
	<!-- 可选的Bootstrap主题文件（一般不用引入） -->
	<link rel="stylesheet" href="../css/bootstrap-theme.min.css">
<!-- 	<style type="text/css">
		img{margin:5px;}
	</style> -->
	<style type="text/css">
		.gallery{list-style-type:none;}
		.gallery li{float:left;}
		.gallery li a,.gallery li img{ width:128px;height: 128px;margin:5px;}
	</style>
	<link rel="stylesheet"  href="../css/zoom.css" media="all" />
	
	<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
	<script type="text/javascript" src="../js/jquery-1.9.1.js"></script>
	
	<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
	<script  src="../js/bootstrap.min.js"></script>
	
  </head>
  
  <body>
    <!-- navigate each page should have -->
	<nav class="navbar navbar-default navbar-static-top navbar-inverse">
		<div class="container-fluid">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed"
					data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
					<span class="sr-only">Toggle navigation</span> 
					<span class="icon-bar"></span> 
					<span class="icon-bar"></span> 
					<span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="#">Lungcare</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<div class="collapse navbar-collapse"
				id="bs-example-navbar-collapse-1">
				<ul class="nav navbar-nav">
					<li class="active"><a href="#">File <span class="sr-only">(current)</span>
					</a>
					</li>
					<li><a href="#">Link</a>
					</li>
					<li class="dropdown"><a href="#" class="dropdown-toggle"
						data-toggle="dropdown" role="button" aria-haspopup="true"
						aria-expanded="false">Dropdown <span class="caret"></span>
					</a>
						<ul class="dropdown-menu">
							<li><a href="#">Action</a>
							</li>
							<li><a href="#">Another action</a>
							</li>
							<li><a href="#">Something else here</a>
							</li>
							<li role="separator" class="divider"></li>
							<li><a href="#">Separated link</a>
							</li>
							<li role="separator" class="divider"></li>
							<li><a href="#">One more separated link</a>
							</li>
						</ul></li>
				</ul>
				<form class="navbar-form navbar-left" role="search">
					<div class="form-group">
						<input type="text" class="form-control" placeholder="Search">
					</div>
					<button type="submit" class="btn btn-default">Submit</button>
				</form>
				<ul class="nav navbar-nav navbar-right">
					<li><a href="#">Link</a>
					</li>
					<li class="dropdown"><a href="#" class="dropdown-toggle"
						data-toggle="dropdown" role="button" aria-haspopup="true"
						aria-expanded="false">Dropdown <span class="caret"></span>
					</a>
						<ul class="dropdown-menu">
							<li><a href="#">Action</a>
							</li>
							<li><a href="#">Another action</a>
							</li>
							<li><a href="#">Something else here</a>
							</li>
							<li role="separator" class="divider"></li>
							<li><a href="#">Separated link</a>
							</li>
						</ul></li>
				</ul>
			</div>
			<!-- /.navbar-collapse -->
		</div>
		<!-- /.container-fluid -->	
	</nav>

	<div style="width: 90%; margin:0 auto">

		<ul class="nav nav-tabs">
			<li class="active"><a href="#UploadFiles" data-toggle="tab">UploadFiles</a>
			</li>
			<li><a href="#Received" data-toggle="tab">Received</a>
			</li>
			<li><a href="#Send" data-toggle="tab">Send</a>
			</li>
			<li><a href="#Complete" data-toggle="tab">Complete</a>
			</li>
			<li><a href="#Morphy" data-toggle="tab">Morphy</a>
			</li>
			<li><a href="#CT" data-toggle="tab">CT</a>
			</li>
			<li><a href="#MorphyBmp" data-toggle="tab">MorphyBmp</a>
			</li>
		</ul>

		<div id="myTabContent" class="tab-content">
			<div class="tab-pane fade in active" id="UploadFiles" style="text-align:center;">
				<form class="form-inline" role="form" method="post" enctype="multipart/form-data" onsubmit="get_action2(this)" >
					<div class="form-group">
						<input type="file"  class="btn btn-primary" name="Singlefile"/> 
					</div>
						<input type="submit" value="压缩包上传" class="btn btn-default"/>
				</form>
				<br>
				<form class="form-inline" role="form" method="post" enctype="multipart/form-data" onsubmit="get_action(this)" >
					<div class="form-group">
						<!-- <label  for="inputfile">多文件上传</label> -->
						<input type="file"  class="btn btn-primary" name="Multifile" multiple="multiple" /> 
					</div>
						<input type="submit" value="多文件上传" class="btn btn-default"/>
				</form>
				<br>
				<form class="form-inline" role="form" method="post" enctype="multipart/form-data" onsubmit="get_action(this)">
					<div class="form-group">
						<!-- <label  for="inputfile">文件夹上传</label> -->
						<input type="file"  class="btn btn-primary" name="Folderfile" webkitdirectory directory multiple /> 
					</div>
						<input type="submit" value="文件夹上传" class="btn btn-default" />
				</form>
				<br />
				<div class="progress" style="width: 50%;margin:auto;">
					<div class="progress-bar" role="progressbar" aria-valuenow="60"
						aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
				</div>
			</div>
			
			
			<div class="tab-pane fade" id="Received" style="text-align: center;">
					<table class="table table-bordered table-hover">
						<tr style="background-color:#3399CC">
							<td colspan="10" style="color: white;">receive</td>
						</tr>
						<tr>
							<td>AccessionNumber</td>
							<td>PatientName</td>
							<td>StudyDate</td>
							<td>IP</td>
							<td>Port</td>
							<td>Received</td>
							<td>Failed</td>
							<td>Speed</td>
							<td>TotalFiles</td>
							<td>Date</td>
						</tr>
						<tbody id="tb1">
						</tbody>
					</table>
					<ul class="pagination">
						<li><a href="#" id="lastPage1">&laquo;</a></li>
						<li><a href="#" id="currentPage1">1</a></li>
						<li><a href="#" id="nextPage1">&raquo;</a></li>
					</ul>
			</div>
			
			<div class="tab-pane fade" id="Send" style="text-align: center;">
				<table class="table table-bordered table-hover">
					<tr style="background-color:#3399CC">
						<td colspan="12" style="color: white;">send</td>
					</tr>
					<tr>
						<td>ID</td>
						<td>AccessionNumber</td>
						<td>PatientName</td>
						<td>StudyDate</td>
						<td>IP</td>
						<td>Port</td>
						<td>Send</td>
						<td>Failed</td>
						<td>SavedFolder</td>
						<td>Speed</td>
						<td>TotalFiles</td>
						<td>Date</td>
					</tr>
					<tbody id="tb2">
					</tbody>
				</table>
				<ul class="pagination">
					<li><a href="#" id="lastPage2">&laquo;</a></li>
					<li><a href="#" id="currentPage2">1</a></li>
					<li><a href="#" id="nextPage2">&raquo;</a></li>
				</ul>
			</div>
			
			<div class="tab-pane fade" id="Complete" style="text-align: center;">
				<button class="btn btn-primary " id="refreshComplete" type="submit">Refresh</button>
				<form id="downloadForm"></form>	
					<table class="table table-bordered table-hover">
						<tr style="background-color:#3399CC">
							<td colspan="20" style="color: white;">complete</td>
						</tr>
						<tr>
							<td>ID</td>
							<td>InstitutionName</td>
							<td>PatientName</td>
							<td>StudyDate</td>
							<td>Date</td>
							<td>CompleteTime</td>
							<td>TotalFiles</td>
							<td>Complete</td>
							<td>ReHandler</td>
							<td>Morphy</td>
							<td>JPGAxial</td>
							<td>CT</td>
							<td>MorphyBmp</td>
							<td>DownSEG</td>
							<td>DownDCM</td>
							<td>DownCTmhd</td>
							<td>LeakingDataSelect</td>
							<td>LeakingUp</td>
							<td>LeakingDown</td>
							<td>Delete</td>
						</tr>
						<tbody id="tb3">
						</tbody>
					</table>
				<ul class="pagination">
					<li><a href="#" id="lastPage3">&laquo;</a></li>
					<li><a href="#" id="currentPage3">1</a></li>
					<li><a href="#" id="nextPage3">&raquo;</a></li>
				</ul>
			</div>
			
			<div class="tab-pane fade" id="Morphy">
					<ul class="nav nav-tabs">
						<li class="active"><a href="#axial" data-toggle="tab">axial</a></li>
						<li><a href="#coronal" data-toggle="tab">coronal</a></li>
						<li><a href="#sagittal" data-toggle="tab">sagittal</a></li>
					</ul>
					<div class="tab-pane fade in active" id="axial" style="text-align: center;"></div>
					<div class="tab-pane fade" id="coronal" style="text-align: center;"></div>
					<div class="tab-pane fade" id="sagittal" style="text-align: center;"></div>
			</div>
			
			<div class="tab-pane fade" id="CT">
				<ul class="nav nav-tabs">
					<li class="active"><a href="#axial" data-toggle="tab">axial</a></li>
					<li><a href="#coronal" data-toggle="tab">coronal</a></li>
					<li><a href="#sagittal" data-toggle="tab">sagittal</a></li>
				</ul>
				<div class="tab-pane fade in active" id="axial1" style="text-align: center;"></div>
				<div class="tab-pane fade" id="coronal1" style="text-align: center;"></div>
				<div class="tab-pane fade" id="sagittal1" style="text-align: center;"></div>
			</div>
			
			<div class="tab-pane fade" id="MorphyBmp" style="text-align: center;">
				<div id="morphyBMP"></div>
			</div>
		</div>
	</div>
	
</body>
<script type="text/javascript" language="javascript">
	var id = null;
 	$(function() {
 		$('#refreshComplete').on("click",function(){
 			findCompleteByCurrentPage();
 		}); 		
 		
		$('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
			// 获取已激活的标签页的名称
			var activeTab = $(e.target).text();
			if (activeTab == "Morphy") {
				activeTab = "axial";
				$('#axial').empty();
				$('#coronal').empty();
				$('#sagittal').empty();
				if (id != null) {
					if (activeTab == "axial") {
						showAllBmp(id, "axial");
					}
					if (activeTab == "coronal") {
						showAllBmp(id, "coronal");
					}
					if (activeTab == "sagittal") {
						showAllBmp(id, "sagittal");
					}
				}
			}
			
			if(activeTab == "CT"){
				activeTab = "axial1";
				$('#axial1').empty();
				$('#coronal1').empty();
				$('#sagittal1').empty();
				if(id != null){
					if(activeTab=="axial1"){}
					showAllBmp(id,"dcm,axial");
				}
			}
			
			if(activeTab=="MorphyBmp"){
				$('#morphyBMP').empty();
				$('#morphyBMP').append('<img id="wholemorphy" src="../allBmps/'+id+'/morphy.bmp" style="width:512px;height:512px;">');
			}
			
			$('#wholemorphy').on("click",function(){
				$('wholemorphy').fadeIn(600);
			});
		});
	});
	
	
	var tablebody;
	function showAllBmp(id, folderPath) {
	var path = id + "," + folderPath;
	$.ajax({
		type : 'get',
		url : '/transfer/rest/remotefile/getAllBmpPath/' + path,
		data : {},
		dataType : 'JSON',
		async:false,
		success : function(result) {
			var dataObj = result['bmpPathEntity'];
			tablebody = '<div class="container" style="text-align:center;"><ul class="gallery">';
			path = path.replace(/,/gm,"/");//替换掉全部的"/"
			$.each(dataObj,function(i, item) {
				tablebody += '<li><a href="../allBmps/'+path+'/'+item.bmpPath+'"><img width="128px" height="128px"  src="../allBmps/'+path+'/'+item.bmpPath+'" ></a></li>';
			});
			tablebody += '</ul></div>';
		}
	});
				if (folderPath == "axial") {
					$('#axial').append(tablebody);
				} else if (folderPath == "coronal") {
					$('#coronal').append(tablebody);
				} else if (folderPath == "sagittal") {
					$('#sagittal').append(tablebody);
				} else if (folderPath == "dcm,axial"){
					$('#axial1').append(tablebody);
				} 
				else {
					alert('there is no bmp');
				}
				$('head').append('<script type="text/javascript" src="../js/zoom.min.js"/>');
	}

	//以下内容为显示Received和Send表格
	var currentPage1 = parseInt($('#currentPage1').html());
	var currentPage2 = parseInt($('#currentPage2').html());
	var currentPage3 = parseInt($('#currentPage3').html());
	var pageSize = 50;
	
	$(function() {
		$('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
			// 获取已激活的标签页的名称
			var activeTab = $(e.target).text();
			if (activeTab == "Received") {
				findReceiveByCurrentPage();
			}
			if (activeTab == "Send") {
				findSendByCurrentPage();
			}
			if (activeTab == "Complete") {
				findCompleteByCurrentPage();
			}
		});

		$('#lastPage1').click(function() {
			currentPage1 -= 1;
			findReceiveByCurrentPage();
			$('#currentPage1').html(currentPage1 + '');
		});

		$('#nextPage1').click(function() {
			currentPage1 += 1;
			findReceiveByCurrentPage();
			$('#currentPage1').html(currentPage1 + '');
		});

		$('#lastPage2').click(function() {
			currentPage2 -= 1;
			findSendByCurrentPage();
			$('#currentPage2').html(currentPage2 + '');
		});

		$('#nextPage2').click(function() {
			currentPage2 += 1;
			findSendByCurrentPage();
			$('#currentPage2').html(currentPage2 + '');
		});
		
		$('#lastPage3').click(function() {
			currentPage3 -= 1;
			findCompleteByCurrentPage();
			$('#currentPage3').html(currentPage3 + '');
		});

		$('#nextPage3').click(function() {
			currentPage3 += 1;
			findCompleteByCurrentPage();
			$('#currentPage3').html(currentPage3 + '');
		});
		
	});

		
	function findCompleteByCurrentPage() {
		var dataObj;
		$.ajax({
			type : 'get',
			url : '/transfer/rest/remotefile/getCompleteReceiveEntity',
			data : {},
			dataType : 'JSON',
			async:false,
			success : function(result) {
				if (result == "" || result == null) {
					alert("there is no data in the table receiveEntity!");
				} else {
					dataObj = result['receiveEntity'];
					$('#tb3').empty();
					var maxPage = Math.ceil(dataObj.length / pageSize);
					if (currentPage3 < 1) {
						currentPage3 = 1;
					}
					
					if (currentPage3 > maxPage) {
						currentPage3 = maxPage;
					}
					
					var firstIndex = (currentPage3 - 1) * pageSize;
					var lastIndex = currentPage3 * pageSize;
			
					if (currentPage3 == maxPage) {
						lastIndex = dataObj.length;
					}
					
					for ( var i = firstIndex; i < lastIndex; i++) {
						var item = dataObj[i];
						var date = item.date;
						date = date.replace("T"," ");
						date = date.substring(0,date.indexOf("+"));
						$('#tb3').append('<tr><td>' + item.id 
						+ '</td><td>' + item.institutionName 
						+ '</td><td>' + item.patientName 
						+ '</td><td>' + item.studyDate 
						+ '</td><td>' + date 
						+ '</td><td>' + item.completeTime/1000+"(s)" 
						+ '</td><td>' + item.totalFiles 
						+ '</td><td>' + item.complete
						+ '</td><td><button class="btn btn-default btn-bmp" type="submit">reHandler</button>'
						+ '</td><td><button class="btn btn-default" type="submit">check</button>'
						+ '</td><td>' + item.jpgAxial
						+ '</td><td><button class="btn btn-default" type="submit">check</button>'
						+ '</td><td><button class="btn btn-default" type="submit">check</button>'
						+ '</td><td><button class="btn btn-default" type="submit"><img src="../img/myicons/download16.png"></button>'
						+ '</td><td><button class="btn btn-default" type="submit"><img src="../img/myicons/download16.png"></button>'
						+ '</td><td><button class="btn btn-default" type="submit"><img src="../img/myicons/download16.png"></button>'
						+ '</td><td><form class="form-inline" role="form" method="post" enctype="multipart/form-data" id='+item.id+'><input type="file" class="btn btn-sm" name="singlefile"><form>'
						+ '</td><td><button class="btn btn-default" type="submit"><img src="../img/myicons/upload16.png"></button>'
						+ '</td><td><button class="btn btn-default" type="submit"><img src="../img/myicons/download16.png"></button>'
						+ '</td><td><button class="btn btn-default btn-bmp" type="submit"><img alt="demo" src="../img/myicons/del.png"></button></td></tr></form>');
					}
					
					$('#tb3 tr').find('td:eq(8)').on("click",function(){
						id = $(this).parents('tr').find('td:first').text();
						if(id != null){
							reHandlerSeg(id);
						}
					});
					
					$('#tb3 tr').find('td:eq(9)').on("click", function() {
						id = $(this).parents('tr').find('td:first').text();
						if (id != null) {
							$(".nav-tabs li:eq(4) a").tab('show');
						}
					});
					
					$('#tb3 tr').find('td:eq(11)').on("click", function() {
						id = $(this).parents('tr').find('td:first').text();
						if (id != null) {
							$(".nav-tabs li:eq(5) a").tab('show');
						}
					});
					$('#tb3 tr').find('td:eq(12)').on("click", function() {
						id = $(this).parents('tr').find('td:first').text();
						if (id != null) {
							$(".nav-tabs li:eq(6) a").tab('show');
							$('#morphyBMP').empty();
							$('#morphyBMP').append('<img src="../allBmps/'+id+'/morphy.bmp" style="width:512px;height:512px;">');
						}
					});
					
 					$('#tb3 tr').find('td:eq(13)').on("click",function(){
						id = $(this).parents('tr').find('td:eq(0)').text();
						if(id!=null){
							$('#downloadForm').attr("action","../rest/remotefile/downloadSeg/"+id);
							$('#downloadForm').submit();
						}
					});
					
 					$('#tb3 tr').find('td:eq(14)').on("click",function(){
						id = $(this).parents('tr').find('td:eq(0)').text();
						if(id!=null){
							$('#downloadForm').attr("action","../rest/remotefile/downloadDCM/"+id);
							$('#downloadForm').submit();
						}
					});
 					$('#tb3 tr').find('td:eq(15)').on("click",function(){
						id = $(this).parents('tr').find('td:eq(0)').text();
						if(id!=null){
							$('#downloadForm').attr("action","../rest/remotefile/downloadCTmhd/"+id);
							$('#downloadForm').submit();
						}
					});
 					$('#tb3 tr').find('td:eq(17)').on("click",function(){
						id = $(this).parents('tr').find('td:eq(0)').text();
						if(id!=null){
							$('#'+id).attr("action","../rest/remotefile/uploadLeakingData/"+id);
							$('#'+id).submit();
						}
					});
					
 					$('#tb3 tr').find('td:eq(18)').on("click",function(){
						id = $(this).parents('tr').find('td:eq(0)').text();
						if(id!=null){
							$('#downloadForm').attr("action","../rest/remotefile/downloadLeakingData/"+id);
							$('#downloadForm').submit();
						}
					});
					
					$('#tb3 tr').find('td:last').on("click", function() {
						id = $(this).parents('tr').find('td:first').text();
						if (id != null) {
							deleteCompleteData(id);
							findCompleteByCurrentPage();
						}
					});
					
				}
			}
		});
		
	}
	
	function reHandlerSeg(id){
		$.ajax({
			type:'post',
			url:'/transfer/rest/remotefile/reHandlerSeg/'+id,
			data:{},
			dataType:'JSON',
			success:function(result){
			}
		});
	}
	
	function deleteCompleteData(id){
		$.ajax({
			type:'post',
			url:'/transfer/rest/remotefile/deleteCompleteData/'+id,
			data:{},
			dataType:'JSON',
			async:false,
			success:function(result){
				alert("delete success!");
			}
		});
	}

	function findReceiveByCurrentPage() {
		$.ajax({
			type : 'get',
			url : '/transfer/rest/remotefile/getAllReceiveEntity',
			data : {},
			dataType : 'JSON',
			async:false,
			success : function(result) {
				if (result == "" || result == null) {
					alert("there is no data in the table receiveEntity!");
				} else {
					dataObj = result['receiveEntity'];
					$('#tb1').empty();
					var maxPage = Math.ceil(dataObj.length / pageSize);
					if (currentPage1 < 1) {
						currentPage1 = 1;

					}
					if (currentPage1 > maxPage) {
						currentPage1 = maxPage;

					}
					var firstIndex = (currentPage1 - 1) * pageSize;
					var lastIndex = currentPage1 * pageSize;

					if (currentPage1 == maxPage) {
						lastIndex = dataObj.length;
					}
					for ( var i = firstIndex; i < lastIndex; i++) {
						var item = dataObj[i];
						var date = item.date;
						date = date.replace("T"," ");
						date = date.substring(0,date.indexOf("+"));
						$('#tb1').append(
								'<tr><td>' + item.accessionNumber + '</td><td>' 
										+ item.patientName + '</td><td>' 
										+ item.studyDate + '</td><td>' 
										+ item.ip + '</td><td>' 
										+ item.port + '</td><td>'
										+ item.received + '</td><td>'
										+ item.failed + '</td><td>'
										+ item.speed + '</td><td>'
										+ item.totalFiles + '</td><td>'
										+ date + '</td></tr>');
					}
				}
			}
		});
	}

	function findSendByCurrentPage() {
		$.ajax({
			type : 'get',
			url : '/transfer/rest/remotefile/getAllSendEntity',
			data : {},
			dataType : 'JSON',
			async:false,
			success : function(result) {
				if (result == "" || result == null) {
					alert("there is no data in the table sendEntity!");
				} else {
					var dataObj = result['sendEntity'];
					$('#tb2').empty();
					var maxPage = Math.ceil(dataObj.length / pageSize);
					if (currentPage2 < 1) {
						currentPage2 = 1;
					}
					if (currentPage2 > maxPage) {
						currentPage2 = maxPage;
					}
					var firstIndex = (currentPage2 - 1) * pageSize;
					var lastIndex = currentPage2 * pageSize;
					if (currentPage2 == maxPage) {
						lastIndex = dataObj.length;
					}
					for ( var i = firstIndex; i < lastIndex; i++) {
						var item = dataObj[i];
						var date = item.date;
						date = date.replace("T"," ");
						date = date.substring(0,date.indexOf("+"));
						$('#tb2').append(
								'<tr><td>' + item.id + '</td><td>'
										+ item.accessionNumber + '</td><td>'
										+ item.patientName + '</td><td>'
										+ item.studyDate + '</td><td>'
										+ item.ip + '</td><td>' + item.port
										+ '</td><td>' + item.send + '</td><td>'
										+ item.failed + '</td><td>'
										+ item.savedFolder + '</td><td>'
										+ item.speed + '</td><td>'
										+ item.totalFiles + '</td><td>'
										+ date + '</td></tr>');
					}
				}

			}
		});
	}

	//以下内容为上传文件
	var current_guid;
	function get_action(form) {
		current_guid = guid();
		form.action = "/transfer/rest/remotefile/multipleFiles/" + current_guid;
		progressBar();
	}
	
	function get_action2(form) {
		current_guid = guid();
		form.action = "/transfer/rest/remotefile/singleFile/" + current_guid;
		progressBar();
	}
	
	var interval;
	function progressBar() {
		interval = setInterval(changeProgress, 500);
	}
	
	function changeProgress() {
		$.ajax({
			url : '/transfer/rest/remotefile/getReceiveEntity/' + current_guid,
			type : 'get',
			data : {},
			dataType : 'JSON',
			success : function(result) {
				//var dataObj = eval("(" + result + ")");
				var dataObj = result;
				if(dataObj==null){
					return;
				}
				var arrayObj = new Array(2);
				arrayObj = [ dataObj.received, dataObj.totalFiles ];
				if (arrayObj == null) {
					return;
				}
				var received = parseInt(arrayObj[0]);
				var totalFiles = parseInt(arrayObj[1]);
				var dataProgress = received / totalFiles;
				var stringProgress = toPercent(dataProgress);

				$('.progress-bar').html(stringProgress);
				$('.progress-bar').css("width", stringProgress);

				if (received >= totalFiles) {
					alert("upload success!!!");
					clearInterval(interval);
					$('.progress-bar').html("0%");
					$('.progress-bar').css("width", "0%");
				}

			}

		});
	}

	function toPercent(data) {
		var strData = parseFloat(data) * 10000;
		strData = Math.round(strData);
		strData /= 100;
		strData = strData.toFixed(0);
		var ret = strData.toString() + "%";
		return ret;
	}

	//Jquery生成Guid方法：
	function s4() {
		return Math.floor((1 + Math.random()) * 0x10000).toString(16)
				.substring(1);
	};
	function guid() {
		return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4()
				+ s4() + s4();
	}
</script>
<!-- <script type="text/javascript" src="../js/zoom.min.js"></script> -->
</html>
